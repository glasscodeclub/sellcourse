<!DOCTYPE html>
<html lang="en">

<%- include("./partials/header") -%>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top">
        <div class="container d-flex align-items-center">
            <!-- <h1 class="logo me-auto"><a href="index.html"></a></h1> -->
            <!-- Uncomment below if you prefer to use an image logo -->
            <a href="/" class="logo me-auto"><img src="assets/img/logo_white.png" alt="" class="img-fluid" /></a>

            <nav id="navbar" class="navbar order-last order-lg-0">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a  href="/courses">Courses</a></li>
                    <li><a href="/pricing">Pricing</a></li>
                    <li><a href="/about">About</a></li>
                    <% if(login && login===true){ %>
                        <li class="dropdown"><a class="active" href="/profile" class="profile-btn">
                                Profile<i class="bi bi-chevron-down"></i></a>
                            <ul>
                                <li><a class="active" href="/profile" style="color: black;">My Courses</a></li>
                                <li><a href="/contact" style="color: black;">Help</a></li>
                                <li><a href="/logout" style="color: #5fcf80;">Logout</a></li>
                            </ul>
                        </li>
                    <% } else { %>
                            <li><a href="/signup">Get Started</a></li>
                    <% } %>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav>
            <!-- .navbar -->
        </div>
    </header>
    <!-- End Header -->


    <!-- ======= Breadcrumbs ======= -->
    <div class="breadcrumbs about-mbl-view" data-aos="fade-in" style="background-color: #273036">
        <div class="container" style="padding: 15px;  ">
            
            <h2><%- course.title -%> </h2>
            <div class="rating" style="color: white;">
                Rated : &nbsp;
                <% course.averageRating=Math.round(course.averageRating) %>
                    <% for(let rating=0; rating < course.averageRating; rating++){ %>
                        <span><i class="bx bxs-star" style="color: white;"></i></span>
            
                        <% } %>
                            <% for(let j=5 - course.averageRating; j> 0; j--){ %>
                                <span><i class="bx bx-star" style="color: white;"></i></span>
                                <% } %>
            </div>
            <br>
            <p>
            <%- course.description -%>
            </p>
        </div>
    </div>
    <!-- End Breadcrumbs -->
    <div class="wrapper">
        <main id="main">
            <!-- ======= Cource Details Section ======= -->
            <section id="course-details" class="course-details">
                <div class="container" data-aos="fade-up">
                    <div class="row">
                        <div class="background-img" style="margin: 0px !important;">
                            <video  width="100%" controls id="current_video" 
                            data-vid="<%-playlist[0].id%>" onended="updateStatus(this)" >
                                <source  src="/video/sample"  type="video/mp4">
                            </video> 
                            <div class="details-below-course">
                                <h3 >
                              <%if(certAvailable == true){%>
                                        <a style="font-size: 14px;
                              background: #5fcf8131;
                              padding: 7px 14px;
                              color: #5fcf80;
                              margin-top: 10px;
                              max-width: 180px;
                              border: 1px solid #5fcf80;
                              border-radius: 10px;
                              text-decoration: none;"
                              href="/profile/mycourses/<%-course.id%>/cert"> Download Certificate</a>
                             
                                    <% }  %>
                                </h3>
                                <p>
                                    And to make that easier, you would typically use a framework like Django - simply because that allows
                                    you to
                                    focus on
                                    your core business logic and you don't need to re-invent the wheel and implement all the
                                    nitty-gritty
                                    technical details
                                    from scratch.
                                </p>
                            </div>

                                    <div style="max-height: 70vh; height: auto; box-shadow: none; border-bottom: none; background-color: #eef0ef;"
                                        class="sidebar-container-hidden">
                                        <div class="playlist">
                                            <h2 style="text-align: center;">
                                                <%- course.title -%>
                                            </h2>
                            
                            
                                        </div>
                                        <div class="sidebar-container-content-group">
                                            <% let bool2=false; %>
                                                <div style="padding: 10px;" class='cta'>
                                                    <h4 style="padding-left: 20px; margin-left: 15px;">
                                                        <%- playlist.length -%> &nbsp; Lessons
                                                    </h4>
                                                    <ul>
                                                        <% for(let i=0; i < playlist.length; i++){ %>
                                                            <% bool2=false %>
                                                                <% for(let j=0; j < validity.videos.length; j++){ %>
                                                                    <% if(validity.videos[j]==playlist[i]._id){ %>
                                                                        <% bool2=true; break; %>
                                                                            <% } %>
                                                                                <% } %>
                                                                                    <% if(bool2==true){ %>
                                                                                        <li style="cursor: pointer; color: #5fcf80"
                                                                                            id="<%= playlist[i]._id %>" onclick="changeVideo(this)">
                                                                                            <%- i+1 %>. &nbsp;
                                                                                                <%- playlist[i].name -%>
                                                                                                    <% } else { %>
                                                                                        <li style="cursor: pointer;" id="<%= playlist[i]._id %>"
                                                                                            onclick="changeVideo(this)">
                                                                                            <%- i+1 %>. &nbsp;
                                                                                                <%- playlist[i].name -%>
                                                                                                    <% } %>
                                                                                                        <% } %>
                                                    </ul>
                                                </div>
                                        </div>
                            
                                    </div>

<!-- div for playlist end-->



                        </div>

                    </div>
                </div>
            </section>
            <!-- End Cource Details Section -->

            <!-- description -->
            
            <section id="information" class="information">
                <div class="container" data-aos="fade-up">
                    <div class="row instructors" data-aos="zoom-in" data-aos-delay="100" style="padding: 1.6rem 2.4rem;">
            
                        <div class="section-title">
                            <h2>About the course</h2>
                            <p>Description</p>
                        </div>
                        <div class="information">
                            <p>Python is the most popular programming language of the world - it's versatile, easy to learn and very
                                powerful!</p>
            
                            <p>We already got a Python course which you can take if you want to learn Python.</p>
                            <p>But one of the primary things you can build with Python is a website! You can use Python for web
                                development.
                            </p>
            
                            <p>And to make that easier, you would typically use a framework like Django - simply because that allows
                                you to
                                focus on
                                your core business logic and you don't need to re-invent the wheel and implement all the
                                nitty-gritty
                                technical details
                                from scratch.</p>
            
                            And this course is about Django - the most popular Python web development framework out there!
            
                            <p>Django covers all aspects of web development - from handling requests and responses, over rendering
                                dynamic
                                HTML pages
                                with templates, all the way up to making database access and data management easy. It's all baked in
                                and it's
                                all
                                covered in great detail in this course!</p>
            
                            <p>This course teaches Django from the ground up - you don't need to know anything about it to get
                                started.
                                Basic Python
                                and web development knowledge is all you need.</p>
            
                            <p>We'll start at the absolute basics and understand how to create Django project, how to run them and
                                how to
                                add features
                                - step by step.</p>
            
                            In detail, this course covers:
                            <ul>
                                <li>Installing Django</li>
                                <li>Creating and understanding Django projects</li>
                                <li>Understanding URLs, views, requests and responses</li>
            
                                <li>Working with templates and static files like CSS and images</li>
            
                                <li>Working with data and models</li>
            
                                <li>Connecting data with relationships (one-to-many, one-to-one, many-to-many)</li>
            
                                <li>Querying data with Django's powerful model solution</li>
            
                                <li>Adding administration panels to your projects</li>
            
                                <li>Handling user input with forms - manually and with Django's built-in form support</li>
            
                                <li>Advanced features like class-based views (and when to use them)</li>
            
                                <li>Dealing with file uploads and how to serve uploaded files</li>
            
                                <li>Working with sessions</li>
            
                                <li>In-depth deployment instructions and examples</li>
            
                                <li>Different ways of deploying and serving static files and user uploads</li>
            
                                <li>And much more!</li>
                            </ul>
            
                            All those concepts are taught in great depth and backed up by a complete example course project where we
                            build a
                            "Blog
                            website" from the ground up.
            
                            <p>Therefore, you'll learn all the important concepts and the theory and you're also going to be able to
                                see it
                                applied to
                                a real project.</p>
            
                            <p> Hence, once you completed the course, you'll have a very solid understanding of Django and you'll be
                                able to
                                dive into
                                your own Django projects!</p>
                        </div>
                    </div>
                </div>
            </section>
            <!-- end description section -->


            <section id="perks" class="perks">
                <div class="container" data-aos="fade-up">
                    <div class="row" data-aos="zoom-in" data-aos-delay="100">
                        <div class="section-title" style="padding: 1.6rem 2.4rem;">
            
                            <p>Important Details</p>
                        </div>
                        <div class="box col-lg-4 col-md-6 col-sm-12 d-flex align-items-stretch">
                            <div style="
                              background-color: #5fcf80;
                              color: aliceblue;
                              text-align: center;
                              padding: 30px;
                            " class="member-content">
                                <h4>Shareable Certificate</h4>
                                <p>
                                    <%if(certAvailable==true){%>
                                        
                                        <a style="color: white;" href="/verify/<%=validity.certificate.uuid%>">
                                        Click here and copy the link from the address bar
                                        </a>
                                        
                                    <% } else { %>
                                    Available on course completion,
                                        <% } %>
                                </p>
                            </div>
                        </div>
                        <div class="box col-lg-4 col-md-6 col-sm-12 d-flex align-items-stretch">
                            <div style="
                              background-color: #5fcf80;
                              color: aliceblue;
                              text-align: center;
                              width: 100%;
                              padding: 30px;"
                              class="member-content">
                                <h4>Valid for 6 months</h4>
                                <p>
                                    <% if(login==true){ %>
                                        Your course is valid till <%-expiresOn%>
                                            <% } else{ %>
                                                The course is valid for 6 months from the date of purchase, this is to ensure
                                                learning at proper pace and you can renew your course once it expires
                                                <% } %>
                                </p>
                            </div>
                        </div>
                        <div class="box col-lg-4 col-md-6 col-sm-12 d-flex align-items-stretch">
                            <div style="
                              background-color: #5fcf80;
                              color: aliceblue;
                              text-align: center;
                              padding: 30px;
                            " class="member-content">
                                <h4>Add a review</h4>
                                <p>
                                    Let others know about your views on the course and share insights and gather data and make
                                    purchases accordingly
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- End Perks Section -->


            

            <!-- Rating & Reviews Section -->
            <section id="reviews" class="reviews">
                <div class="container" data-aos="fade-up">
                    <div class="row" data-aos="zoom-in" data-aos-delay="100" style="padding: 1.6rem 2.4rem;">
                        <div class="section-title">
                            <h2>Reviews</h2>
                           <p>Latest Reviews</p> 
                        </div>
                        <ul class="list-group">
                            <% for(let i = 0; i < reviews.length; i++){ %>
                            <li class="list-group-item" style="margin: 10px; border: 1px solid rgba(0, 0, 0, 0.125); border-radius: 5px;"><strong>By: &nbsp;<%- reviewUsers[i].username  %></strong>
                                &nbsp; | &nbsp;
                                <% for(let rating = 0; rating < reviews[i].rating; rating++){ %> 
                                    <span><i class="bx bxs-star"></i></span>
                                    
                                <% } %>
                                <% for(let j = 5 - reviews[i].rating; j > 0; j--){ %>
                                    <span><i class="bx bx-star"></i></span><span></span>
                                <% } %>
                                <p><%- reviews[i].createdAt %></p>
                                <p><%- reviews[i].text %></p>
                            </li>
                            <% } %>
                        </ul>
                        <% if(role && role != 'publisher' && rev === false){ %>
                        <div class="container" data-aos="fade-up">
                            <div class="row" data-aos="zoom-in" data-aos-delay="100" style="padding: 3rem 0.7rem;">
                                <div class="section-title">
                                    <h2>Feedback</h2>
                                    <p>Your Review</p>
                                </div>
                                    <form id="feedback" onsubmit="return validateForm()"  action="/profile/mycourses/<%-course.id%>" method="POST">
                                    
                                        <div class="pinfo">Rate the course.</div>
                                    
                                    
                                        <div class="form-group">
                                            <div class="col-md-4 inputGroupContainer">
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="fa fa-heart"></i></span>
                                                    <select name="rating" class="form-control" id="rating">
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5" selected>5</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    
                                        <div class="pinfo">Write your feedback.</div>
                                    
                                    
                                    
                                        <div class="form-group">
                                            <div class="col-md-10 inputGroupContainer">
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="fa fa-pencil"></i></span>
                                                    <textarea name="text" class="form-control" id="review" rows="5"></textarea>
                                    
                                                </div>
                                            </div>
                                        </div>
                                    
                                        <button type="submit" class="btn btn-primary">Submit</button>
                                    
                                    
                                    </form> 

                                <!--   <form method="POST" action="/profile/mycourses/<%-course.id%>" id="review-form">
                                    
                                        <div class="formGroup">
                                            <select name="rating" class="form-control" id="rate">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                            
                                            <textarea name="text" class="form-control" id="review" rows="3"></textarea>
                                        </div>
                                        <button class="btn btn-primary">Submit</button>
                                    </form> -->
                                </div>
                                </div>
                    </div>
                    <% } %>
                </div>
            </section>
            <!-- End Rating & Reviews Section -->
        </main>
        <!-- End #main -->

        <!-- Sidebar-Container Section -->
        <section id="sidebar-container" style="border: 0px;" class="sidebar-container">
            <div class="container"  data-aos="fade-up">
                <div class="row" data-aos="zoom-in" data-aos-delay="100">
                    <div style="max-height: 70vh; height: auto; box-shadow: none; border-bottom: none; background-color: #eef0ef;"  class="sidebar-container-content">
                        <div class="playlist">
                            <h2 style="text-align: center;">
                                <%- course.title -%>
                            </h2>
                        
                        
                        </div>
                        <div class="sidebar-container-content-group">
                            <%  let bool = false; %>
                            <div style="padding: 10px;" class='cta'>
                                <h4 style="padding-left: 20px;">
                                    <%- playlist.length -%> &nbsp; Lessons
                                </h4>
                                <ul>
                                    <% for(let i=0; i < playlist.length; i++){ %>
                                        <% bool = false %>
                                        <% for(let j = 0; j < validity.videos.length; j++){ %>
                                            <% if(validity.videos[j] == playlist[i]._id){ %>
                                                <% bool = true; break;  %>
                                            <% } %>
                                        <% } %>
                                        <% if(bool == true){ %>
                                            <li style="cursor: pointer; color: #5fcf80" id="<%= playlist[i]._id %>" onclick="changeVideo(this)">
                                            <%- i+1 %>. &nbsp;
                                            <%- playlist[i].name -%>
                                        <% } else { %>
                                            <li style="cursor: pointer;" id="<%= playlist[i]._id %>" onclick="changeVideo(this)">
                                            <%- i+1 %>. &nbsp;
                                            <%- playlist[i].name -%>
                                        <% } %>
                                    <% } %>
                                </ul>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </section>

        <!-- End Sidebar-Container Section -->
    </div>
    <!-- End Wrapper Section -->

    <!-- ======= Footer ======= -->
    <%- include("./partials/footer") %>
        <!-- End Footer -->

        <div id="preloader"></div>
        <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
                class="bi bi-arrow-up-short"></i></a>

        <!-- Vendor JS Files -->
        <script src="assets/vendor/aos/aos.js"></script>
        <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="assets/vendor/php-email-form/validate.js"></script>
        <script src="assets/vendor/purecounter/purecounter.js"></script>
        <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

        <!-- Template Main JS File -->
        <script src="assets/js/main.js"></script>
        <script src="https://unpkg.com/pdf-lib@1.4.0"></script>
        <script src="https://unpkg.com/downloadjs@1.4.7"></script>
         <script>
         function changeVideo(e){
             // update vid 
            document.getElementById("current_video").setAttribute('data-vid', e.id);

            // replace the video
            document.getElementById("current_video").innerHTML='<source src="/video/'+e.id+'" type="video/mp4">';
            document.getElementById("current_video").load();
            document.getElementById("current_video").play();
         }
         </script>
         <script>
             function validateForm() {
                    let x = document.forms["feedback"]["review"].value;
                    if (x == "") {
                        alert("Please add your feedback");
                        return false;
                    }
                }
         </script>
         <script>
             function updateStatus(event){
                 var vidId = document.getElementById("current_video");

                 var originalTitle = document.getElementById(vidId.dataset.vid).innerHTML
                 /*document.getElementById(vidId.dataset.vid).innerHTML='<i class="bi bi-check"></i>' + originalTitle; */
                 document.getElementById(vidId.dataset.vid).style.color="#5fcf80";
                 

                 const xhttp = new XMLHttpRequest();
                 const url = window.location.href + "/mark/" + vidId.dataset.vid ;
                 xhttp.open("POST", url);
                 xhttp.send();
                 //console.log(event.data + " has ended");
             }
            // const video = document.querySelector('current_video');
            // video.onended = (event) => {
            //     console.log(event.id + ' has ended');
            // };
         </script>
                                   
</body>

</html>